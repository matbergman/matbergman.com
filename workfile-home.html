<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Mat Bergman</title>

    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="https://use.typekit.net/mhn7kil.css">

    <link rel="stylesheet" href="css/screen.css" />

    <style type="text/css">
    
    .scale__Content {
        overflow-y: hidden;
        width: 100%;
        height: 100vh;
        background-image:
            radial-gradient(
            circle at bottom left,
            #0f111e 0%,
            #0a0918 80%
            );
        }


        .stripes {
            display: flex;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 10;
            transform: rotate(0deg);
            width: 100%;
            height: 100%;
            transition: 0.5s;
            transition-timing-function: ease-out;            
        }

        .stripe {
            visibility: hidden;
            width: 3px;
            margin-right: 18px;
            height: calc(100% + 80px);
        }

            .stripe--active {
                visibility: visible;
            }

            .stripe:nth-child(n+5) {
                display: none;
            }

            .stripe:last-child {
                margin-right: 0;
            }

            .stripe__0 {
                background-color: #da7317;
            }

            .stripe__1 {
                background-color: #da171b;
            }

            .stripe__2 {
                background-color: #da7317;
            }

        .header__Home {
            display: block;
            position: absolute;
            width: 275px;
            height: 92px;
            margin: 0;
            padding: 0;
            top: 0.5em;
            right: 0.5em;
            text-indent: -9999px;
            z-index: 20;
            background-image:url(../images/logo.svg);
        }

        .content__Home {
            font-family: botanika-web, sans-serif;
            color: #ffffff;
            position: relative;
            margin-right: 1em;
            margin-left: 4em;
            margin-top: 200px;
            opacity: 0;
            transition: 0.125s;
            transition-delay: 0.25s;
            transition-timing-function: ease-out;
        }

            .content__Home--active {
                opacity: 1;
            }

        .content__Home__Polygon {
            display: none;
            shape-outside: polygon(0 0, 80px 0, 0 100%);
            width: 100%;
            height: 400px;
            float: left;
        }

        .content__Home__Text {
            font-size: 1.6em;
            line-height: 1.4;
            letter-spacing: .05em;
            margin: 0;
        }





@media only screen and (min-width: 768px) {

    .stripes {
        width: auto;
        transform: rotate(10.5deg);
    }

    .stripe:nth-child(n+5) {
        display: block;
    }

    .header__Home {
        right: -18px;
        top: calc(33% - 105px);
        width: 315px;
            height: 105px;
    }

    .content__Home {
        margin-left: -200px;
        margin-right: 2em;
        position: absolute;
        top: 33%;
        left: 452px;
        margin-top: 0;
    }

    .content__Home__Polygon {
        display: block;
    }

    .content__Home__Text {
        font-size: 2em;
    }

}

@media only screen and (min-width: 960px) {

    .content__Home {
        margin-left: 0;
    }

    .stripes {
            left: 200px;
        }
    
}


    </style>

  </head>

  <body>

    <div class="scale__Content"></div>
    
    
    
    <script>

        window.onresize = function() {
            layoutUpdate();
        };


        // mock data
        const mockHomeHeader = "Mat Bergman";
        const mockHomeContent = "I'm Mat. You may know me from my professional work as a software engineer and user experience designer. Or maybe you came across my photography or animation projects. You can also send me a message."
        const mockStripeCount = 14;

        // init - create elements
        const contentElem = document.querySelector(".scale__Content");
        const stripeWrapper = document.createElement("div");
        stripeWrapper.classList.add("stripes");

        const headerHome = document.createElement("h1");
        headerHome.classList.add("header__Home");
        headerHome.innerText = mockHomeHeader;

        stripeWrapper.appendChild(headerHome);

        let classIncrement = 0;
        for (let i=0; i<mockStripeCount; i++) {
            const stripeElem = document.createElement("span");
            stripeElem.classList.add("stripe", "stripe__"+classIncrement);
            stripeElem.setAttribute("role", "presentation");
            stripeWrapper.appendChild(stripeElem);

            if (classIncrement < 2) {
                classIncrement ++;
            }
            else {
                classIncrement = 0;
            }
        }
        
        const contentHome = document.createElement("div");
        contentHome.classList.add("content__Home");

        const contentHomePolygonElem = document.createElement("span");
        contentHomePolygonElem.classList.add ("content__Home__Polygon");
        contentHomePolygonElem.setAttribute("role", "presentation");

        const contentHomeTextElem = document.createElement("p");
        contentHomeTextElem.classList.add("content__Home__Text");
        
        contentHome.appendChild(contentHomePolygonElem);
        contentHome.appendChild(contentHomeTextElem);

        contentElem.appendChild(stripeWrapper);
        contentElem.appendChild(contentHome);

        // init - configure homepage stripes for animation
        const stripes = document.querySelectorAll(".stripe");
        const stripesRect = stripes[stripes.length-1].getBoundingClientRect();
        const offsetLeft = (stripesRect.left + stripesRect.width)*-1;
        const startStripeAnimValue = 0.4;
        const endStripeAnimValue = 1;
        const stripeAnimValue = (endStripeAnimValue - startStripeAnimValue) / stripes.length;
        let stripeAnimIncrement = startStripeAnimValue;
        let stripeAnimArr = [];   

        for (let i=0; i<stripes.length; i++) {
            stripes[i].style.transform = `translateY(-34px) translateX(${offsetLeft}px)`;
        }

        // init - configure homepage header
        isTablet()? headerHome.style.transform = `rotate(-10.5deg) translateX(${offsetLeft}px)` : headerHome.style.transform = `rotate(0deg) translateX(0px)`;  

        // init - configure content
        let contentHomeText = document.querySelector(".content__Home__Text");
        let contentHomeString = mockHomeContent.split(/(\s+)/);

        if (isTablet()) {
            console.log(stripeWrapper.getBoundingClientRect());
            // contentHome.style.left = stripeWrapper.getBoundingClientRect().width + "px";
        }

        else {
            // contentHome.style.left = "auto";
        }

        if (isHd()) {
            contentHome.style.maxWidth = window.innerWidth / 4 + "px";
        }

        else if (isDesktop()) {
            contentHome.style.maxWidth = window.innerWidth / 2 + "px";          
        }

        else {
            contentHome.style.maxWidth = "none";
        }

        document.addEventListener("DOMContentLoaded", function() {
  
            // stripes - timing values
            for (let i=0; i<stripes.length; i++) {
                stripeAnimIncrement = stripeAnimIncrement + stripeAnimValue;
                stripeAnimArr[i] = stripeAnimIncrement;
            }
            stripeAnimArr.reverse()

            setTimeout(function(){

                // stripes - animate
                for (let i=0; i<stripes.length; i++) {
                    stripes[i].classList.add("stripe--active");
                    stripes[i].style.transform = "translateY(-34px) translateX(0px)";
                    stripes[i].style.transition = `${stripeAnimArr[i]}s`;
                    stripes[i].style.transitionTimingFunction = "ease-out";
                }

                // header - animate
                if (isTablet()) {
                    headerHome.style.transform = "rotate(-10.5deg) translateX(0px)";
                    headerHome.style.transition = "0.5s";
                    headerHome.style.transitionDelay = "0.5s";
                    headerHome.style.transitionTimingFunction = "ease-out";
                }

                // content - animate
                setTimeout(function() {
                    contentHome.classList.add("content__Home--active");
                    for (let i=0; i<contentHomeString.length; i++) {
                        setTimeout(function(){
                            contentHomeText.innerHTML += contentHomeString[i];
                        }, i*10 );
                    }
                }, 500);

            }, 100);

        });


        function isTablet() {
            return window.innerWidth >= 768;
        }

        function isDesktop() {
            return window.innerWidth >= 960;
        }

        function isHd() {
            return window.innerWidth >= 1600;
        }

        function layoutUpdate() {
            headerHome.style.transition = "0s";
            stripeWrapper.style.transition = "0s";
            contentHome.style.transition = "0s";
            if (isHd()) {
                contentHome.style.maxWidth = window.innerWidth / 4 + "px";                
            }
            else if (isTablet()) {
                headerHome.style.transform = `rotate(-10.5deg) translateX(0px)`;
                // contentHome.style.left = stripeWrapper.getBoundingClientRect().width + "px";
                contentHome.style.maxWidth = window.innerWidth / 2 + "px";
            }
            else {
                headerHome.style.transform = `rotate(0deg) translateX(0px)`; 
               // contentHome.style.left = "auto";
                contentHome.style.maxWidth = "none";
            }

            if (window.innerHeight >= 1080) {

            }

        }

        </script>
    
    

  </body>

</html>